---
layout: default
comments: true
title: [BSN] 3.개발시작
parent: 프로젝트 진행기
date: 2019.06.08
---

<h1>{{ page.title }}</h1>  
<div style="text-align:right; font-size:11px; color:#aaa">{{ page.date }} </div>

---

본 프로젝트는 다음 링크를통해 확인하실수 있습니다.  
  
Homepage : <http://www.stocknews.me>  
Github : <https://github.com/taes-k/stock_analysis>  

---

## 3. 개발 시작

---

### Crawler

가장먼저 뉴스데이터 수집을 위해 크롤링 개발을 진행했습니다. 크롤러는 파이썬 request와 BeautifulSoup 라이브러리를 통해 데이터들을 간단하게 가져올수 있습니다.  
  
하지만 속보 탭에는 정치,사회,과학 뉴스들 부터 스포츠,해외 뉴스들이 모두 포함되어 사실상 주가변동과는 크게 관련없는 신문사들을 선정해 블랙리스트로 걸러 데이터 수집을 진행했습니다.  

---

### 형태소 분석기

이제 크롤링해온 뉴스데이터 분석을 위해 형태소 분석기를 사용할 차례입니다. Python에는 한국어 정보처리를 위한 형태소분석기 패키지인 KoNLPy 오픈소스가 있습니다. 이 패키지 내에는 Kkma, Twitter, Mecab등의 여러 형태소 분석기가 포함되어 있어 사용 목적에 따라 분석기를 선택해 사용이 가능합니다. [KoNLPy 참고자료](http://konlpy.org/ko/v0.4.3/morph/)  
  
어떤 분석기를 사용할까 고민중에 마침 Elasticsearch에서도 기본 한글형태소분석기(nori-analyzer)를 제공한다는 소식을 확인하고 데이터 저장소도 Elasticsearch로 쓸겸 nori를 사용하기로 결정했습니다.    
  
---

### Positive 알고리즘

이제 뉴스기사의 호의도를 분석하기 위해 세워두웠던 알고리즘을 실행시킬수 있게되었습니다.   
> 1\. 뉴스 제목을 형태소 분석을 통해 쪼개기  
> 2\. 형태소별 Positive 점수를 매긴 샘플 Positive 딕셔너리 제작   
> 3\. 결과로써 나온 점수를 반영해 Positive 딕셔너리 반영 (학습)     
  
하지만 아직 샘플 Positive 딕셔너리가 없기때문에 1000개 정도의 뉴스기사를 하나씩 크롤링하면서 호의도를 직접 판단하여 Positive 딕셔너리를 학습시켜 나갔습니다. 해당 딕셔너리는 다음과 같이 저장되었습니다.
  
```
keyword, positive
날씨NNG, 0
투자NNG, 1
개발NNG, 1
기초NNG, -1
조사NNG, -1
법원NNG, -1
기초NNG, 1
단계NNG, 1
투자NNG, 1
투자NNG, -1
실패NNG, -1
```  
  
어느정도 완성된 샘플 Positive 딕셔너리를 이용해 직접 뉴스기사들을 Positive 점수를 계산해보니 굉장히 신뢰도가 낮은 결과를 얻었습니다. 사실, 위의 딕셔너리를 보면 알수있다시피 앞,뒤 조사 하나 만으로도 문맥이 완전히 달라 질 수 있기때문에 하나의 형태소로써 점수를 매겨 분석을 한다는것 자체가 거의 불가능하다는 것을 깨달았습니다.  
  
첫번째 알고리즘부터 난관이 생겨서 구글링을 하던도중 서울대학교에서 저와 비슷한 개념을 통해 형태소별 감성 정도를 분석해둔 딕셔너리가 있었습니다. [참고](http://word.snu.ac.kr/kosac/lexicon.php)  
속으로 유레카를 외치며 해당 딕셔너리를 참고하려 하였으나 해당 딕셔너리의 경우 다른 분석기를 사용하여 nori와는 형태소의 차이가 있었으며 이 또한 정적인 데이터분석으로 신뢰도가 그렇게 높지는 않을것이라는 판단이 들었습니다. 다만 해당 딕셔너리에서는 형태소 낱개단위로 점수를 매긴것이 아닌 형태소의 집합단위로 딕셔너리를 구성해 둔것을 보고 좋은 힌트를 얻을 수 있었습니다.  
  
다음에서 이어집니다!

---
